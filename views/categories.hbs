<div class="container">
	<div class="row">
		<div class="pb-2 mt-4 mb-2 col-md-4">
			<!--header-->
			<h1><strong>Categories</strong></h1>
		</div>
	</div>
	<div class="row">
		<div class="offset-8 col-md-4">
			<button class="btn badge-pill btn-outline-primary btn-sm" data-toggle="modal"
				data-target="#addCategoryModal">
				Add Category
			</button>

		</div>
	</div>

	<div class="row">
		<div class="col-md-12">
			<div class="table" id="order-data">
				<table id="categoriesTable" class="table table-striped table-hover">
					<div class="table responsive">
						<thead>
							<tr>
								<th data-field="categoryName" data-sortable="true">Category Name</th>
								<th data-field="prodCount" data-sortable="true"># Products</th>
								<th data-sortable="false"></th>
							</tr>
						</thead>
						<tbody>
									{{#each categories}}
								<tr class="categoryRow" data-toggle="modal" data-id='{{_id}}'></tr>
								<td>{{name}}</td>
								<td>{{count}}</td>
								<td>
										<button type="button" class="btn btn-danger deleteButton">
											<i class="fas fa-trash deleteButton" data-id="{{_id}}"></i>
										</button>
									</td>
								</tr>
									{{/each}}
							
						</tbody>
					</div>
				</table>
			</div>
			</table>
		</div>
		<!--table-->
	</div>
</div>
<!--row-->
</div>

<script>	$(document).ready(function(){

  $('#categoriesTable').DataTable();
});

function deleteRow(rowId) {
		var deleteIt = confirm("Are you sure you want to delete the category?");
		if (deleteIt) {
			$.get("/deleteCategory/" + rowId, (data) => {
				$('.categoryRow').attr('data-target', '#cancelOrderModal');
				console.log("request complete" + data.success);
				location.reload();
			});

		}
	}

		$(".categoryRow").click((e) => {
		if ($(e.target).hasClass("deleteButton")) {
			deleteRow($(e.currentTarget).data("id"));		
		}
	})
</script>